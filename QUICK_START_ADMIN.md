# Быстрый старт - Админ-панель

## Запуск проекта

1. **Установите зависимости:**
   ```bash
   npm install
   ```

2. **Настройте базу данных:**
   ```bash
   # Создайте файл .env на основе .env.example
   cp .env.example .env

   # Отредактируйте .env и укажите данные PostgreSQL
   # DB_HOST=localhost
   # DB_PORT=5432
   # DB_NAME=teplo_arctici
   # DB_USER=postgres
   # DB_PASSWORD=your_password
   # JWT_SECRET=your_secret_key
   ```

3. **Инициализируйте базу данных:**
   ```bash
   npm run db:init
   npm run db:seed
   ```

4. **Запустите сервер:**
   ```bash
   npm run dev
   ```

5. **Откройте браузер:**
   ```
   http://localhost:3000
   ```

## Доступ к админ-панели

### URL
```
http://localhost:3000/admin/
```

### Учетные данные
```
Email: admin@teplo-arctici.ru
Пароль: admin123
```

## Быстрый тест функций

### 1. Вход в систему
1. Откройте `/admin/`
2. Введите email и пароль
3. Нажмите "Войти"
4. Должно перенаправить на `/admin/dashboard.html`

### 2. Транзакции
1. На странице Dashboard вы увидите:
   - Общую сумму собранных средств
   - Форму добавления транзакции
   - Таблицу последних транзакций с пагинацией

2. **Добавить транзакцию:**
   - Введите сумму: `5000`
   - Выберите сбор из списка
   - Введите email или отметьте "Анонимное"
   - Нажмите "Добавить"
   - Должно появиться уведомление об успехе
   - Таблица автоматически обновится

3. **Экспорт CSV:**
   - Нажмите кнопку "Экспорт CSV"
   - Скачается файл с транзакциями

### 3. Сборы
1. Перейдите на `/admin/campaigns.html`
2. Вы увидите карточки всех сборов

3. **Создать новый сбор:**
   - Нажмите "Создать сбор"
   - Заполните форму:
     - Название: `Помощь пострадавшим от пожаров`
     - Описание: `Сбор средств для восстановления домов...`
     - Сумма: `1000000`
     - URL изображения: `https://picsum.photos/1200/600` (опционально)
   - Нажмите "Создать"
   - Новый сбор появится в списке

4. **Редактировать сбор:**
   - Нажмите "Изменить" на любой карточке
   - Измените данные
   
   - Нажмите "Обновить"

5. **Удалить сбор:**
   - Нажмите красную кнопку с корзиной
   - Подтвердите удаление

### 4. Отчеты
1. Перейдите на `/admin/reports.html`
2. Вы увидите таблицу всех отчетов

3. **Добавить отчет:**
   - Нажмите "Добавить отчет"
   - Откроется модальное окно
   - Заполните форму:
     - Сбор: выберите из списка
     - Дата: выберите дату
     - Сумма: `25000`
     - Описание: `Покупка продуктов питания для пострадавших семей`
     - Поставщик: `ООО "Продукты"`
     - Ссылка на чек: `https://example.com/receipt.pdf` (опционально)
   - Нажмите "Сохранить отчет"

4. **Редактировать отчет:**
   - Нажмите на иконку карандаша
   - Измените данные
   - Нажмите "Обновить отчет"

5. **Удалить отчет:**
   - Нажмите на иконку корзины
   - Подтвердите удаление

### 5. Темная тема
- На любой странице админ-панели должна работать темная тема
- Переключите в системных настройках или добавьте кнопку переключения

### 6. Выход
- Нажмите на кнопку "Выход" в сайдбаре
- Подтвердите действие
- Должно перенаправить на `/admin/`

## Проверка API

### Вручную через curl

**Авторизация:**
```bash
curl -X POST http://localhost:3000/api/admin/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@teplo-arctici.ru","password":"admin123"}'
```

**Получить транзакции (с токеном):**
```bash
curl http://localhost:3000/api/admin/donations \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"
```

**Создать транзакцию:**
```bash
curl -X POST http://localhost:3000/api/admin/donations \
  -H "Authorization: Bearer YOUR_TOKEN_HERE" \
  -H "Content-Type: application/json" \
  -d '{
    "amount": 5000,
    "campaign_id": 1,
    "donor_email": "test@example.com",
    "is_anonymous": false,
    "payment_method": "manual"
  }'
```

## Просмотр публичного сайта

Откройте главную страницу для просмотра того, как данные отображаются для обычных пользователей:

```
http://localhost:3000/
```

Вы должны увидеть:
- Live-ленту пожертвований
- Список активных сборов
- Статистику

## Типичные проблемы

### Проблема: "Ошибка сервера"
**Решение:**
- Проверьте, что PostgreSQL запущен
- Проверьте настройки в `.env`
- Проверьте логи сервера в консоли

### Проблема: "Не авторизован"
**Решение:**
- Очистите localStorage в браузере
- Войдите заново
- Проверьте, что токен не истек (24 часа)

### Проблема: "Сборы не загружаются"
**Решение:**
- Проверьте, что база данных инициализирована
- Запустите `npm run db:seed` для тестовых данных
- Проверьте консоль браузера на ошибки

### Проблема: "Стили не работают"
**Решение:**
- Убедитесь, что Tailwind CDN загружается
- Проверьте консоль браузера на ошибки загрузки
- Попробуйте жесткую перезагрузку (Ctrl+Shift+R)

## Следующие шаги

После успешного тестирования:

1. **Измените учетные данные администратора:**
   - Подключитесь к базе данных
   - Обновите email и пароль в таблице `admins`

2. **Настройте продакшн окружение:**
   - См. документацию по деплою
   - Настройте HTTPS
   - Включите production режим

3. **Добавьте реальные данные:**
   - Создайте реальные сборы
   - Загрузите изображения баннеров
   - Начните принимать пожертвования

## Полезные ссылки

- [Полная документация админ-панели](./ADMIN_PANEL.md)
- [Основной README](./README.md)
- [Чек-лист функций](./ADMIN_CHECKLIST.md)
- [Документация проекта](./CLAUDE.md)

## Поддержка

При возникновении проблем:
1. Проверьте логи сервера
2. Проверьте консоль браузера
3. Сверьтесь с документацией API
4. Проверьте настройки базы данных
